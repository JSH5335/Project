<!DOCTYPE html>
<html lang="ja" xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<title>ç®¡ç†è€… | é€šå ±ã‚³ãƒ¡ãƒ³ãƒˆç®¡ç†</title>

<link rel="stylesheet" href="/css/main.css">
<link rel="stylesheet" href="/css/admin.css">
<link rel="stylesheet" href="/css/admin_comments.css">

<style>
.reply-row td.comment-content {
    padding-left: 24px;
    background: #f9fafb;
}
.reply-badge {
    font-size: 11px;
    color: #6b7280;
    margin-right: 6px;
}

/* ================= pagination (í†µì¼) ================= */
.pagination {
    display: flex;
    justify-content: center;
    gap: 6px;
    margin-top: 24px;
}

.pagination a,
.pagination span {
    min-width: 34px;
    height: 34px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 8px;
    font-size: 13px;
    font-weight: 600;
    text-decoration: none;
}

.pagination a {
    background: #f3f4f6;
    color: #111827;
}

.pagination a:hover {
    background: #e5e7eb;
}

.pagination .active {
    background: #dc2626;
    color: #ffffff;
    font-weight: 700;
}
</style>
</head>

<body th:classappend="${session.darkMode == true} ? ' dark' : ''">

<div class="layout">

    <div th:replace="admin/fragments/sidebar :: adminSidebar"></div>

    <section class="main">

        <div class="header">
            <h1>ğŸš¨ é€šå ±ã‚³ãƒ¡ãƒ³ãƒˆç®¡ç†</h1>
            <p class="sub-text">é€šå ±ã•ã‚ŒãŸã‚³ãƒ¡ãƒ³ãƒˆã‚’ç¢ºèªãƒ»å¯¾å¿œã—ã¾ã™</p>
        </div>

        <div class="admin-table-card">

            <table class="admin-table">
                <thead>
                    <tr>
                        <th>NO</th>
                        <th>ã‚³ãƒ¡ãƒ³ãƒˆå†…å®¹</th>
                        <th>ä½œæˆè€…</th>
                        <th>å…ƒè¨˜äº‹</th>
                        <th>ä½œæˆæ—¥æ™‚</th>
                        <th>å¯¾å¿œ</th>
                    </tr>
                </thead>

                <tbody>
                    <tr th:each="comment, stat : ${reportedComments}"
                        th:classappend="${comment.depth == 1} ? 'reply-row'">

                        <td th:text="${currentPage * 10 + stat.index + 1}"></td>

                        <td class="comment-content">
                            <span th:if="${comment.depth == 1}"
                                  class="reply-badge">â†³ è¿”ä¿¡</span>

                            <span class="reported"
                                  th:text="${comment.content}">
                            </span>
                        </td>

                        <td th:text="${comment.userName}"></td>

                        <td>
                            <a th:href="@{/post/view/{id}(id=${comment.postId})}"
                               target="_blank"
                               class="link-post">
                                è¡¨ç¤º
                            </a>
                        </td>

                        <td th:text="${#temporals.format(comment.createdAt,'yyyy-MM-dd HH:mm')}"></td>

                        <td>
                            <div class="actions">

                                <form th:action="@{/admin/reported-comments/ignore}"
                                      method="post">
                                    <input type="hidden"
                                           name="commentId"
                                           th:value="${comment.commentId}">
                                    <button type="submit"
                                            class="admin-action-btn btn-ignore">
                                        ç„¡è¦–
                                    </button>
                                </form>

                                <form th:action="@{/admin/reported-comments/soft-delete}"
                                      method="post">
                                    <input type="hidden"
                                           name="commentId"
                                           th:value="${comment.commentId}">
                                    <button type="submit"
                                            class="admin-action-btn btn-soft">
                                        éè¡¨ç¤º
                                    </button>
                                </form>

                                <form th:action="@{/admin/reported-comments/hard-delete}"
                                      method="post">
                                    <input type="hidden"
                                           name="commentId"
                                           th:value="${comment.commentId}">
                                    <input type="hidden"
                                           name="parentId"
                                           th:value="${comment.parentId}">
                                    <button type="submit"
                                            class="admin-action-btn btn-delete">
                                        å®Œå…¨å‰Šé™¤
                                    </button>
                                </form>

                            </div>
                        </td>

                    </tr>

                    <tr th:if="${#lists.isEmpty(reportedComments)}">
                        <td colspan="6" style="text-align:center;color:#9ca3af;">
                            é€šå ±ã•ã‚ŒãŸã‚³ãƒ¡ãƒ³ãƒˆã¯ã‚ã‚Šã¾ã›ã‚“ã€‚
                        </td>
                    </tr>

                </tbody>
            </table>

            <div class="pagination" th:if="${totalPages > 1}">
                <a th:if="${currentPage > 0}"
                   th:href="@{/admin/reported-comments(page=${currentPage - 1})}">
                    â€¹
                </a>

                <span th:each="i : ${#numbers.sequence(0, totalPages - 1)}">
                    <a th:if="${i != currentPage}"
                       th:href="@{/admin/reported-comments(page=${i})}"
                       th:text="${i + 1}">
                    </a>
                    <span th:if="${i == currentPage}"
                          class="active"
                          th:text="${i + 1}">
                    </span>
                </span>

                <a th:if="${currentPage < totalPages - 1}"
                   th:href="@{/admin/reported-comments(page=${currentPage + 1})}">
                    â€º
                </a>
            </div>

        </div>

        <footer>
            ç®¡ç†è€…ãƒšãƒ¼ã‚¸ Â· Jo's Developer Blog
        </footer>

    </section>

</div>

</body>
</html>